;----------------------------------------------------------------
; 进入一场战斗
; 战斗结果要怎么区分各种情况，有逃跑吗，待定。总之先只考虑 -1未知 0战败 1战胜
; duelMode
; 0 常规死斗(目标是把对方血量打光，可以逃跑)
; 1 友好切磋(具体规则没设计，大概就是打了半血就会退场，先不考虑)
; 其它模式待设计
;----------------------------------------------------------------
@BATTLE_START(enemyTeam, duelMode = 0)
    #DIMS enemyTeam
    #DIM duelMode
    #DIM battleResult
    #DIM loopCount
    #DIM insID

    ; 初始化敌人 将来封装起来 不同类型的战斗要有不同的初始化方法
    SPLIT enemyTeam, ",", LOCALS
    REPEAT RESULT
        insID = New_Chara(TOINT(LOCALS:COUNT))
        CFLAG:insID:TEAM = 2
        BASE:insID:体力 = MAXBASE:insID:体力
        BASE:insID:魔力 = MAXBASE:insID:魔力
        BASE:insID:性欲 = 100
        BASE:insID:快感 = 100
        ENEMY_POS:COUNT = insID
    REND

    CALL BATTLE_FIRST_PLAYER

    ; debug
    FOR loopCount, 0, 4
        LOCALS = TEAMMEMBER%TOSTR(loopCount + 1)%
        PRINTFORML %NAME:(FLAG:LOCALS)%
    NEXT
    RETURN


;----------------------------------------------------------------
; 临时测试用：导入玩家队伍
;----------------------------------------------------------------
@Temp_Import_PlayerTeam(playerTeam)
    #DIMS playerTeam
    #DIM insID

    SPLIT playerTeam, ",", LOCALS
    REPEAT RESULT
        insID = New_Chara(TOINT(LOCALS:COUNT))
        CFLAG:insID:TEAM = 1
        BASE:insID:体力 = MAXBASE:insID:体力
        BASE:insID:魔力 = MAXBASE:insID:魔力
        BASE:insID:性欲 = 100
        BASE:insID:快感 = 100
        PLAYER_POS:COUNT = insID
    REND

    ; 先暴力导入
    FLAG:TEAMMEMBER1 = 1
    FLAG:TEAMMEMBER2 = 2
    FLAG:TEAMMEMBER3 = 3
    FLAG:TEAMMEMBER4 = 4

    RETURN